import { PropsWithChildren } from 'react';
import {
  Sidebar,
  SidebarDivider,
  SidebarGroup,
  SidebarItem,
  SidebarPage,
  SidebarScrollWrapper,
  SidebarSpace,
  useSidebarOpenState,
  Link,
} from '@backstage/core-components';
import { makeStyles } from '@material-ui/core';
import HomeIcon from '@material-ui/icons/Home';
import ExtensionIcon from '@material-ui/icons/Extension';
import LibraryBooks from '@material-ui/icons/LibraryBooks';
import CreateComponentIcon from '@material-ui/icons/AddCircleOutline';
import GroupIcon from '@material-ui/icons/People';
import {
  UserSettingsSignInAvatar,
} from '@backstage/plugin-user-settings';
import SearchIcon from '@material-ui/icons/Search';
import LogoFull from './LogoFull';
import LogoIcon from './LogoIcon';
import { MyGroupsSidebarItem } from '@backstage/plugin-org';

// Define sidebarConfig with default values
const sidebarConfig = {
  drawerWidthClosed: 72,
  logoHeight: 32,
};

const useSidebarLogoStyles = makeStyles({
  root: {
    width: sidebarConfig.drawerWidthClosed,
    height: 3 * sidebarConfig.logoHeight,
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    backgroundColor: '#f4f9ff',
  },
  link: {
    width: '100%',
    display: 'flex',
    justifyContent: 'center',
  },
});

const SidebarLogo = () => {
  const classes = useSidebarLogoStyles();
  const { isOpen } = useSidebarOpenState();

  return (
    <div className={classes.root}>
      <Link to="/" underline="none" className={classes.link} aria-label="Home">
        {isOpen ? <LogoFull /> : <LogoIcon />}
      </Link>
    </div>
  );
};

export const Root = ({ children }: PropsWithChildren<{}>) => (
  <SidebarPage>
    <Sidebar style={{ background: '#f4f9ff' }}>
      <SidebarLogo />
      <SidebarItem icon={SearchIcon} to="/search" text="Search" />
      <SidebarDivider />
      <SidebarItem icon={HomeIcon} to="/home" text="Home" />
      <MyGroupsSidebarItem
        singularTitle="My Group"
        pluralTitle="My Groups"
        icon={GroupIcon}
      />
      <SidebarItem icon={ExtensionIcon} to="/api-docs" text="APIs" />
      <SidebarItem icon={LibraryBooks} to="/docs" text="Docs" />
      <SidebarItem icon={CreateComponentIcon} to="/create" text="Create" />
      <SidebarDivider />
      <SidebarScrollWrapper />
      <SidebarSpace />
      <SidebarDivider />
      <SidebarGroup icon={<UserSettingsSignInAvatar />} to="/settings">
        {/* You can add other settings-related components here if needed */}
      </SidebarGroup>
    </Sidebar>
    {children}
    </SidebarPage>
);
